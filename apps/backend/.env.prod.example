# Production Environment Configuration

# ============================================================================
# REQUIRED - Must be set before deployment
# ============================================================================
SESSION_SECRET=CHANGE_THIS_TO_A_SECURE_RANDOM_STRING

# ============================================================================
# Server Configuration
# ============================================================================
BACKEND_PORT=3001
NODE_ENV=production

# ============================================================================
# Database Configuration
# ============================================================================
POSTGRES_USER=postgres
POSTGRES_PASSWORD=CHANGE_THIS_PASSWORD
POSTGRES_DB=notes_db
POSTGRES_PORT=5432

# Database URL (constructed from above or direct connection string)
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@postgres:5432/${POSTGRES_DB}

# Database Performance Tuning
POSTGRES_SHARED_BUFFERS=512MB
POSTGRES_EFFECTIVE_CACHE_SIZE=2GB
POSTGRES_MAINTENANCE_WORK_MEM=256MB

# ============================================================================
# Redis Configuration (for session storage in cluster mode)
# ============================================================================
REDIS_PORT=6379
REDIS_URL=redis://redis:6379

# ============================================================================
# Security
# ============================================================================
CORS_ORIGIN=https://your-frontend-domain.com

# ============================================================================
# Vertical Scaling Configuration
# ============================================================================

# Cluster Mode (disable for cloud auto-scaling platforms)
# For AWS ECS/GCP Cloud Run/Azure: set to false
# For standalone servers with multiple cores: set to true
CLUSTER_MODE=false

# Worker Processes (only used when CLUSTER_MODE=true)
# Recommended: (Total CPU Cores - 1) to leave one for system
# Example: For 8 cores, set MAX_WORKERS=7
MAX_WORKERS=4

# Memory Configuration
ENABLE_MEMORY_MONITORING=true
MEMORY_THRESHOLD_MB=512

# Node.js Heap Size (in MB)
# Calculate: (Total RAM / MAX_WORKERS) * 0.75
# Example: 16GB RAM, 4 workers â†’ (16384/4) * 0.75 = 3072MB
MAX_OLD_SPACE_SIZE=2048

# ============================================================================
# Docker Resource Limits
# ============================================================================

# Backend Resources
BACKEND_CPU_LIMIT=4           # Maximum CPU cores
BACKEND_CPU_RESERVATION=2     # Minimum CPU cores reserved
BACKEND_MEMORY_LIMIT=8G       # Maximum memory
BACKEND_MEMORY_RESERVATION=4G # Minimum memory reserved

# ============================================================================
# Rate Limiting
# ============================================================================
RATE_LIMIT_WINDOW_MS=900000   # 15 minutes in ms
RATE_LIMIT_MAX_REQUESTS=100   # Max requests per window per IP

# ============================================================================
# Body Parser
# ============================================================================
BODY_PARSER_LIMIT=10mb
